---
# Testinfra vars file for app-staigng.
wanted_apache_headers:
  - 'Header edit Set-Cookie ^(.*)$ $1;HttpOnly'
  - 'Header always append X-Frame-Options: DENY'
  - 'Header set Referrer-Policy "no-referrer"'
  - 'Header set X-XSS-Protection: "1; mode=block"'
  - 'Header set X-Content-Type-Options: nosniff'
  - 'Header set X-Download-Options: noopen'
  - "Header set X-Content-Security-Policy: \"default-src 'self'\""
  - "Header set Content-Security-Policy: \"default-src 'self'\""
  - 'Header unset Etag'

securedrop_code: /var/www/securedrop
securedrop_data: /var/lib/securedrop
securedrop_user: www-data

app_hostname: app-staging
monitor_hostname: mon-staging

apache_listening_address: 127.0.0.1
apache_source_log: /var/log/apache2/source-error.log
apache_allow_from: 127.0.0.1

dns_server: "8.8.8.8"
mon_ip: 10.0.1.3
app_ip: 10.0.1.2

pip_deps:
  - name: 'Flask-Testing'
    version: '0.7.1'
  - name: 'mock'
    version: '2.0.0'
  - name: 'pytest'
    version: '3.3.2'
  - name: 'selenium'
    version: '2.53.6'

apparmor_complain: []

apparmor_enforce:
  - "/sbin/dhclient"
  - "/usr/lib/NetworkManager/nm-dhcp-client.action"
  - "/usr/lib/connman/scripts/dhclient-script"
  - "/usr/sbin/ntpd"
  - "/usr/sbin/tcpdump"
  - "system_tor"
  - "/usr/sbin/apache2"
  - "/usr/sbin/apache2//DEFAULT_URI"
  - "/usr/sbin/apache2//HANDLING_UNTRUSTED_INPUT"
  - "/usr/sbin/tor"

app_directories:
  - /var/www/securedrop
  - /var/lib/securedrop
  - /var/lib/securedrop/store
  - /var/lib/securedrop/keys
  - /var/lib/securedrop/tmp

tor_services:
  - name: ssh
    ports: # remote versus local ports
      - "22"
    authenticated: yes # value will automatically be coerced to boolean
    client: admin

  - name: source
    ports:
      - "80"
    authenticated: no

  - name: journalist
    ports:
      - "80"
      - "8080"
    authenticated: yes
    client: journalist

# Staging permits presence of "source-error.log".
allowed_apache_logfiles:
  - /var/log/apache2/access.log
  - /var/log/apache2/error.log
  - /var/log/apache2/journalist-access.log
  - /var/log/apache2/journalist-error.log
  - /var/log/apache2/other_vhosts_access.log
  - /var/log/apache2/source-error.log
