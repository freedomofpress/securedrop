<IfModule pagespeed_module>
    ModPagespeed on
    ModPagespeedDomain "*"
    # TODO restrict to relevant resources
    ModPagespeedAllow "*"

    ModPagespeedInheritVHostConfig on
    AddOutputFilterByType MOD_PAGESPEED_OUTPUT_FILTER text/html

    ModPagespeedFileCachePath    "/var/cache/mod_pagespeed/"
    ModPagespeedLogDir           "/var/log/pagespeed"
    ModPagespeedSslCertDirectory "/etc/ssl/certs"

    # diasble filters by default
    ModPagespeedRewriteLevel PassThrough

    # TODO add more
    # ensure potentially harmful filters are disabled
    ModPagespeedDisableFilters add_instrumentation,canonicalize_javascript_libraries,inline_google_font_css,insert_ga
    ModPagespeedForbidFilters  add_instrumentation,canonicalize_javascript_libraries,inline_google_font_css,insert_ga

    # only allow the following filters
    ModPagespeedEnableFilters add_head,collapse_whitespace,combine_css,combine_heads,combine_javascript,elide_attributes,flatten_css_imports,move_css_above_scripts,move_css_to_head,remove_comments,remove_quotes,rewrite_css,rewrite_javascript,rewrite_style_attributes

    ModPagespeedRewriteRandomDropPercentage 0
    ModPagespeedFileCacheInodeLimit         500000
    ModPagespeedMessageBufferSize           100000

    <Location /pagespeed_admin>
        Order deny,allow
        Deny from 0.0.0.0
    </Location>
    <Location /pagespeed_global_admin>
        Order deny,allow
        Deny from 0.0.0.0
    </Location>

    # disable stats
    ModPagespeedStatistics off
    ModPagespeedReportUnloadTime off
    ModPagespeedStatisticsLogging off
</IfModule>
